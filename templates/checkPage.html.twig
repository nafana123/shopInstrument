{% include 'header/header.html.twig' %}
<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="../public/style/header/header.css">
    <link rel="stylesheet" href="{{ asset('style/check/check.css') }}">
    <title>{% block title %}История заказов{% endblock %}</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 128 128%22><text y=%221.2em%22 font-size=%2296%22>⚫️</text></svg>">
    {% block stylesheets %}
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    {% endblock %}
</head>
<style>
    h1 {
        text-align: center;
        margin-bottom: 20px;
    }
    h2,h3 {
        margin-top: 30px;
        display: flex;
        justify-content: space-between;
    }

    ul {
        list-style: none;
        padding: 0;
    }
    .l {
        background-color: #fff;
        padding: 20px;
        font-size: 24px;
        margin-bottom: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
    img {
        width: 100px;
        height: 100px;
        object-fit: cover;
        margin-right: 20px;
    }
    .order-details {
        display: flex;
        align-items: center;
    }
    .order-details p {
        margin: 0;
    }
    .order-number {
        font-weight: bold;
    }
    .return-link {
        display: block;
        margin-top: 20px;
        text-align: center;
        color: #007bff;
        text-decoration: none;
    }
    .return-link:hover {
        text-decoration: underline;
    }
</style>
<body>
{% block body %}
    <div class="container">
        <h1>История заказов</h1>
        {% set currentOrderNumber = null %}
        {% for check in checks|reverse %}
        {% if check.orderNumber != currentOrderNumber %}
        {% if currentOrderNumber is not null %}
        {% endif %}
        <h2>
            <span>Заказ №<span class="order-number">{{ check.orderNumber }}</span> ({{ check.dateCreated|date('d.m.Y') }})</span>
            {% if  check.status == 4%}
                <span style="color: darkorange; font-size: 25px">Статус: В обработке</span>
            {% endif %}
        </h2>
        <h3>Итоговая цена: {{ totalPrice }} руб.</h3>

        <ul>
            {% set currentOrderNumber = check.orderNumber %}
            {% endif %}
            <li class="l" style="">
                <div class="order-details">
                    <div>
                        <img src="{{ asset('picture/product/' ~ check.img) }}" alt="{{ check.img }}">
                    </div>
                    <div>
                        <p>{{ check.name }}</p>
                        <p>{{ check.count }} шт. по {{ check.FinalPrice }} руб.</p>

                    </div>
                </div>
            </li>
            {% endfor %}
        </ul>
        <a href="{{ path('mainpage') }}" class="return-link">Вернуться к покупкам</a>
    </div>

{% endblock %}

</body>
</html>
